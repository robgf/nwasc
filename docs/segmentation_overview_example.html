<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">

<head>

<meta charset="utf-8" />
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="pandoc" />

<meta name="viewport" content="width=device-width, initial-scale=1">

<meta name="author" content="Rob Fowler" />

<meta name="date" content="2018-10-02" />

<title>Segmentation Overview</title>



<style type="text/css">code{white-space: pre;}</style>
<style type="text/css">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; position: absolute; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; }
pre.numberSource a.sourceLine:empty
  { position: absolute; }
pre.numberSource a.sourceLine::before
  { content: attr(data-line-number);
    position: absolute; left: -5em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */


</style>



<link rel="stylesheet" href="H:\RPackages\rmarkdown\rmarkdown\templates\html_vignette\resources\vignette.css" type="text/css" />

</head>

<body>




<h1 class="title toc-ignore">Segmentation Overview</h1>
<h4 class="author"><em>Rob Fowler</em></h4>
<h4 class="date"><em>2018-10-02</em></h4>



<div id="introduction" class="section level1">
<h1>Introduction</h1>
<p>The goal of nwasc is to segment survey data from the <a href="https://github.com/USFWS/AMAPPS/tree/master/NWASC">Northwest Atlantic Seabird Catalog (NWASC)</a>. This webpage serves as an overview of the nwasc package. The nwasc r-pack is located at <a href="https://github.com/robgf/nwasc" class="uri">https://github.com/robgf/nwasc</a>.</p>
<p>To attach (install) the nwasc package to your library use the following code:</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1-1" data-line-number="1">devtools<span class="op">::</span><span class="kw">install_github</span>(<span class="st">&quot;robgf/nwasc&quot;</span>)</a></code></pre></div>
<p>Please consider creating a fork to this repository. Requests for fixes or enhancements should be documented with a filled issue at <a href="https://github.com/robgf/nwasc/issues" class="uri">https://github.com/robgf/nwasc/issues</a>.</p>
<p>Plans are to relocate this repository within the U.S. FWS GitHub This site and accompanying documentation will be updated at that time.</p>
</div>
<div id="guiding-principles" class="section level1">
<h1>Guiding Principles</h1>
<p>The goal of this package is to have a</p>
<ul>
<li>Simple</li>
<li>Well documented</li>
</ul>
<p>code with:</p>
<ul>
<li>Reproducible results</li>
</ul>
<p>for segmenting the transect and observation data contained in the <a href="https://github.com/USFWS/AMAPPS/tree/master/NWASC">NWASC</a>]. Request or submissions of data from the NWASC should be made following the directions on the NWASC website.</p>
</div>
<div id="organization" class="section level1">
<h1>Organization</h1>
<p>There are four (4) exported functions. All with prefix “nwasc_” to avoid any conflicts with other packages already installed by the user. The two segmentation functions nwasc_segmentCTS() and nwasc_segmentDTS() are wrapper functions for the family of segmentation internal functions which can be found in the <code>R/</code> directory of the repo. The other exported functions aid in the finalization of the segmented data. In practice there are three segmented data frames, 1) Continuous Time Survey (CTS) data segmented from phase 2 of the NWASC, 2) CTS data segmented from phase 1 of the NWASC and 3) Discrete Time Survey (DTS) data segmented from phase 1 of the NWASC. We do not expect to receive any further DTS as modern surveys use GPS systems during collection active.</p>
<p>The nwasc_segmentCTS() requires queries from three of the NWASC tables. From the <code>obsevations</code> table the following columns need to be pulled:</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb2-1" data-line-number="1"><span class="kw">names</span>(nwasc.ph2.obs.pre)</a>
<a class="sourceLine" id="cb2-2" data-line-number="2"><span class="co">#&gt; [1] &quot;transect_id&quot; &quot;lat&quot;         &quot;long&quot;        &quot;spp_cd&quot;      &quot;count&quot;</span></a></code></pre></div>
<p>From the <code>tracks</code> table:</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb3-1" data-line-number="1"><span class="kw">names</span>(nwasc.ph2.shp.pre)</a>
<a class="sourceLine" id="cb3-2" data-line-number="2"><span class="co">#&gt; [1] &quot;lat&quot;         &quot;long&quot;        &quot;transect_id&quot; &quot;dataset_id&quot;  &quot;piece&quot;      </span></a>
<a class="sourceLine" id="cb3-3" data-line-number="3"><span class="co">#&gt; [6] &quot;order&quot;</span></a></code></pre></div>
<p>From the <code>transect</code> table&quot;</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb4-1" data-line-number="1"><span class="kw">names</span>(nwasc.ph2.cts.dat)</a>
<a class="sourceLine" id="cb4-2" data-line-number="2"><span class="co">#&gt; [1] &quot;start_dt&quot;              &quot;dataset_id&quot;            &quot;source_dataset_id&quot;    </span></a>
<a class="sourceLine" id="cb4-3" data-line-number="3"><span class="co">#&gt; [4] &quot;segmented_transect_id&quot; &quot;transect_id&quot;           &quot;transect_width_nb&quot;    </span></a>
<a class="sourceLine" id="cb4-4" data-line-number="4"><span class="co">#&gt; [7] &quot;survey_type_cd&quot;        &quot;survey_method_cd&quot;</span></a></code></pre></div>
<p><strong>Note:</strong> <code>source_transect_id</code> is renamed <code>segmented_transect_id</code> in the query.</p>
<p>As the location of the NWASC and version of the Catalog vary the precise SQL query will depend on the present circumstances. If the Catalog becomes static this page can be updated with example SQL query.</p>
<p>Example of clean data (circa Summer 2017) included in package (35MB) <code>.rda</code> files are stored in <code>data/</code></p>
</div>
<div id="documentation" class="section level1">
<h1>Documentation</h1>
<div id="short-form" class="section level2">
<h2>Short form</h2>
<ul>
<li>All functions internal and exported of the package are documented using ROxygen2</li>
<li>Function parameters an returns documented along with example usage</li>
<li>Allows for standard R help:</li>
</ul>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb5-1" data-line-number="1">?nwasc</a>
<a class="sourceLine" id="cb5-2" data-line-number="2">?nwasc_SegmentCTS</a></code></pre></div>
<ul>
<li>compiled manuals are located in <code>man/</code> folder.</li>
</ul>
</div>
<div id="long-form-vignette" class="section level2">
<h2>Long form vignette</h2>
<p>Presently this package has one vignette. <code>segmentation_overview_example</code> an html and pdf copy are contained in the <code>doc/</code> folder.</p>
</div>
</div>
<div id="running-code" class="section level1">
<h1>Running code</h1>
<p>Running the code in this package requires queries from the NWASC as described above. Example data that was used for NOAA’s mapping project are located in the <code>data/</code> folder and can be called by name when this package is loaded, see below.</p>
<p><strong>NOTE!</strong> Due to the size of the NWASC this takes a while (Coffee Break Time)</p>
<p>As of the data query used as an example in this package the NWASC consisted of two phases with CTS data in both phases and DTS data in the phase 1. The steps to segment the catalog are: 1. segment the CTS and DTS data by phase (historically from separate database locations) 2. Combine the separate dataframes (note: since tibbles inherit from class ‘data.frame’ data frame and tibble are use interchangeably here.) 3. Write a data stamped .csv for sharing</p>
<p>Example run:</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb6-1" data-line-number="1"><span class="co">#load nwasc paskage (see attaching directions above)</span></a>
<a class="sourceLine" id="cb6-2" data-line-number="2"><span class="kw">library</span>(nwasc)</a>
<a class="sourceLine" id="cb6-3" data-line-number="3">seg.dat.phase2 =<span class="st"> </span><span class="kw">nwasc_segmentCTS</span>(nwasc.ph2.obs.pre,</a>
<a class="sourceLine" id="cb6-4" data-line-number="4">                            nwasc.ph2.shp.pre,</a>
<a class="sourceLine" id="cb6-5" data-line-number="5">                            nwasc.ph2.cts.dat,</a>
<a class="sourceLine" id="cb6-6" data-line-number="6"></a>
<a class="sourceLine" id="cb6-7" data-line-number="7"><span class="dt">seg.dat.phase1.cts =</span> <span class="kw">nwasc_segmentCTS</span>(nwasc.ph1.obs.pre,</a>
<a class="sourceLine" id="cb6-8" data-line-number="8">                                nwasc.ph1.shp.pre,</a>
<a class="sourceLine" id="cb6-9" data-line-number="9">                                nwasc.ph1.cts.dat,</a>
<a class="sourceLine" id="cb6-10" data-line-number="10"></a>
<a class="sourceLine" id="cb6-11" data-line-number="11"><span class="dt">seg.dat.phase1.dts =</span> <span class="kw">nwasc_segmentDTS</span>(nwasc.ph1.dts.obs.dat,</a>
<a class="sourceLine" id="cb6-12" data-line-number="12">                                nwasc.ph1.dts.dat)</a>
<a class="sourceLine" id="cb6-13" data-line-number="13"></a>
<a class="sourceLine" id="cb6-14" data-line-number="14">segmented_seabird_catalogs &lt;-<span class="st"> </span><span class="kw">nwasc_bind_phases</span>(seg.dat.phase2, seg.dat.phase1.cts, seg.dat.phase1.dts)</a>
<a class="sourceLine" id="cb6-15" data-line-number="15"><span class="kw">nwasc_write_segmented_csv</span>(segmented_seabird_catalogs)</a>
<a class="sourceLine" id="cb6-16" data-line-number="16"><span class="kw">zip</span>(<span class="st">&quot;segmented_results&quot;</span>, <span class="dt">file =</span> <span class="st">&quot;segmented_seabird_catalog-2018-09-27-combined_transects_3 .csv&quot;</span>)</a></code></pre></div>
</div>



<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
